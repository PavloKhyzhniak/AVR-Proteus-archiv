;************************************
;** Файл вспомогательных подпрограмм
;**
;**
;************************************

		;-------------------------- Подпрограммы

;пример подпрограммы подготовки данных на вывод
; будь то температура, напряжение, значение тока или другая цифровая информация(не буквенная)
; при необходимости отображать признак точки он должен быть добавлен к извлеченной константе

NumberTC:
; подпрограмма определения цифр для отображения
; рабочий байт передаеться из 
;	tmpL2 это младший байт
; 	tmpH2 это старший байт
		
		ldi tmpL, low(100)
		ldi tmpH, high(100)
		rcall digit
		sts TT2, r0

		ldi tmpL, low(10)
		ldi tmpH, high(10)
		rcall digit
		sts TT1, r0
		
		mov cnt1, tmpL
		rcall number_init
		sts TT0, r0
		
		ret

; подпрограмма разложения числа на разряды
digit:	ldi cnt1, -1	; сразу инициализируем -1
digit_1:inc cnt1		; инкрементируем, т.е. впервый раз начинаем с нуля!!!
		sub tmpL2, tmpL	; вычитание младшего байта
		sbc tmpH2, tmpH	; вычитание с переносом старшего байта
		brsh digit_1	; в случае коль не отрицательное повторить
		add tmpL2, tmpL	; иначе восстанавливаем последнее значение
		adc tmpH2, tmpH	; в итоге остается все что меньше вычитаемого
						; т.е. вычитая 10 остаток единицы!!!
;		ret

; подпрограмма извлечения константы для индикатора из таблицы
number_init:
		ldi zh, high(TableIndicator*2)
		ldi zl, low(TableIndicator*2)
		add zl, cnt1
		clr cnt1
		adc zh, cnt1
		lpm	; результат в R0
		ret
